<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Projects | åˆ›å®¢æ•™è‚²åšå®¢</title>
<meta name="keywords" content="">
<meta name="description" content="Projects - åˆ›å®¢æ•™è‚²åšå®¢">
<meta name="author" content="dmk69">
<link rel="canonical" href="http://localhost:1313/projects/">
<meta name="google-site-verification" content="XYZabc">
<meta name="yandex-verification" content="XYZabc">
<meta name="msvalidate.01" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/projects/index.xml" title="rss">
<link rel="alternate" hreflang="en" href="http://localhost:1313/projects/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/projects/">
  <meta property="og:site_name" content="åˆ›å®¢æ•™è‚²åšå®¢">
  <meta property="og:title" content="Projects">
  <meta property="og:description" content="ä»é‡‘èäº¤æ˜“å‘˜åˆ°åˆ›å®¢æ•™è‚²è€…çš„è½¬å‹ä¹‹è·¯">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="website">
      <meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name="twitter:title" content="Projects">
<meta name="twitter:description" content="ä»é‡‘èäº¤æ˜“å‘˜åˆ°åˆ›å®¢æ•™è‚²è€…çš„è½¬å‹ä¹‹è·¯">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Projects",
      "item": "http://localhost:1313/projects/"
    }
  ]
}
</script>
</head>
<body class="list" id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                <img src="http://localhost:1313/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="http://localhost:1313/">Home</a></div>
  <h1>
    Projects
    <a href="/projects/index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&amp;h=400&amp;fit=crop" alt="æ™ºèƒ½ç”Ÿäº§çº¿æ§åˆ¶ç³»ç»Ÿ">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">æ™ºèƒ½ç”Ÿäº§çº¿æ§åˆ¶ç³»ç»Ÿ
    </h2>
  </header>
  <div class="entry-content">
    <p>ğŸ­ é¡¹ç›®æ¦‚è¿° è¿™æ˜¯ä¸€ä¸ªåŸºäºSiemens S7-1500 PLCçš„æ™ºèƒ½ç”Ÿäº§çº¿æ§åˆ¶ç³»ç»Ÿï¼Œå®ç°äº†ä»ç‰©æ–™è¾“å…¥åˆ°æˆå“è¾“å‡ºçš„å…¨è‡ªåŠ¨åŒ–æ§åˆ¶æµç¨‹ã€‚è¯¥é¡¹ç›®å±•ç¤ºäº†åœ¨å·¥ä¸š4.0èƒŒæ™¯ä¸‹ï¼Œå¦‚ä½•é€šè¿‡å…ˆè¿›çš„PLCç¼–ç¨‹æŠ€æœ¯å®ç°ç”Ÿäº§çº¿çš„æ™ºèƒ½åŒ–æ”¹é€ ã€‚
ğŸ¯ é¡¹ç›®ç›®æ ‡ å®ç°ç”Ÿäº§çº¿å…¨æµç¨‹è‡ªåŠ¨åŒ–æ§åˆ¶ æé«˜ç”Ÿäº§æ•ˆç‡å’Œäº§å“è´¨é‡ é™ä½äººå·¥æ“ä½œé”™è¯¯ç‡ å»ºç«‹å®Œå–„çš„æ•°æ®é‡‡é›†å’Œç›‘æ§ç³»ç»Ÿ å®ç°è®¾å¤‡é—´çš„æ™ºèƒ½è”åŠ¨ ğŸ”§ ç³»ç»Ÿæ¶æ„ ç¡¬ä»¶é…ç½® æ ¸å¿ƒæ§åˆ¶å™¨: â”œâ”€â”€ Siemens S7-1515F-2 PN (CPU) â”œâ”€â”€ SM 521 16Ã—24VDC DI (æ•°å­—é‡è¾“å…¥) â”œâ”€â”€ SM 522 16Ã—24VDC DO (æ•°å­—é‡è¾“å‡º) â”œâ”€â”€ SM 431 8Ã—AI (æ¨¡æ‹Ÿé‡è¾“å…¥) â”œâ”€â”€ SM 432 8Ã—AO (æ¨¡æ‹Ÿé‡è¾“å‡º) â””â”€â”€ CM 1542-5 (PROFIBUS-DP) äººæœºç•Œé¢: â”œâ”€â”€ Siemens TP1200 Comfort (12è‹±å¯¸è§¦æ‘¸å±) â”œâ”€â”€ WinCC Comfort Runtime V15.1 â””â”€â”€ ä»¥å¤ªç½‘é€šä¿¡è¿æ¥ I/Oè®¾å¤‡: â”œâ”€â”€ æ¥è¿‘å¼€å…³ (æ£€æµ‹å·¥ä»¶ä½ç½®) â”œâ”€â”€ å…‰ç”µä¼ æ„Ÿå™¨ (å®‰å…¨åŒºåŸŸæ£€æµ‹) â”œâ”€â”€ å‹åŠ›ä¼ æ„Ÿå™¨ (æ¶²å‹ç³»ç»Ÿç›‘æ§) â”œâ”€â”€ æ¸©åº¦ä¼ æ„Ÿå™¨ (ç”µæœºæ¸©åº¦ä¿æŠ¤) â”œâ”€â”€ å˜é¢‘å™¨ (ç”µæœºé€Ÿåº¦æ§åˆ¶) â””â”€â”€ ä¼ºæœé©±åŠ¨å™¨ (ç²¾ç¡®å®šä½) ç½‘ç»œæ‹“æ‰‘ PROFINETç½‘ç»œæ¶æ„: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ SCADAç³»ç»Ÿ â”‚ â”‚ (ä¸Šä½æœºç›‘æ§) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ PROFINET â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚ S7-1500 PLC â”‚ â”‚ (ä¸»æ§åˆ¶å™¨) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â–¼â”€â”€â”€â”â”Œâ”€â–¼â”€â”€â”€â”â”Œâ”€â–¼â”€â”€â”€â”€â” â”‚TP1200 â”‚â”‚å˜é¢‘å™¨â”‚â”‚ä¼ºæœ â”‚ â”‚HMI â”‚â”‚ â”‚â”‚é©±åŠ¨å™¨ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”˜ ğŸ’» PLCç¨‹åºè®¾è®¡ ä¸»ç¨‹åºç»“æ„ (OB1) // ä¸»ç¨‹åºå¾ªç¯ DATA_BLOCK &#34;ProductionData&#34; BEGIN // ç”Ÿäº§æ•°æ®ç»“æ„ CurrentStep : INT := 0; PartCount : DINT := 0; CycleTime : TIME := T#5S; SystemStatus : WORD := 16#0000; END_DATA_BLOCK ORGANIZATION_BLOCK OB1 BEGIN // ç³»ç»ŸçŠ¶æ€ç›‘æ§ CALL &#34;SystemStatusCheck&#34;; // è‡ªåŠ¨è¿è¡Œæ¨¡å¼ IF &#34;AutoMode&#34; THEN CALL &#34;AutoProductionSequence&#34;; END_IF; // æ‰‹åŠ¨æ“ä½œæ¨¡å¼ IF &#34;ManualMode&#34; THEN CALL &#34;ManualControl&#34;; END_IF; // æ•…éšœè¯Šæ–­ CALL &#34;Diagnostics&#34;; // HMIé€šä¿¡ CALL &#34;HMI_Communication&#34;; END_ORGANIZATION_BLOCK è‡ªåŠ¨ç”Ÿäº§åºåˆ— (FC101) FUNCTION &#34;AutoProductionSequence&#34; : VOID VAR_INPUT StartSignal : BOOL; EmergencyStop : BOOL; END_VAR VAR_OUTPUT SequenceComplete : BOOL; END_VAR VAR StepCounter : INT := 0; TimerValue : TIME; END_VAR BEGIN // ç”Ÿäº§æ­¥éª¤æ§åˆ¶ CASE &#34;ProductionData&#34;.CurrentStep OF 0: // åˆå§‹çŠ¶æ€ - ç­‰å¾…å¯åŠ¨ IF StartSignal AND NOT EmergencyStop THEN &#34;Conveyor_Motor&#34; := TRUE; TimerValue := T#2S; &#34;ProductionData&#34;.CurrentStep := 1; END_IF; 1: // å·¥ä»¶è¾“é€ IF &#34;Workpiece_Detected&#34; AND TimerValue = T#0S THEN &#34;Lifting_Cylinder&#34; := TRUE; TimerValue := T#1S; &#34;ProductionData&#34;.CurrentStep := 2; END_IF; 2: // å·¥ä»¶æå‡ IF &#34;Lift_Up_Position&#34; AND TimerValue = T#0S THEN &#34;Servo_Positioning&#34; := TRUE; &#34;Servo_Target_Position&#34; := 1500; // 15mm TimerValue := T#3S; &#34;ProductionData&#34;.CurrentStep := 3; END_IF; 3: // ç²¾ç¡®å®šä½ IF &#34;Servo_In_Position&#34; AND TimerValue = T#0S THEN &#34;Processing_Station&#34; := TRUE; TimerValue := T#8S; // åŠ å·¥æ—¶é—´ &#34;ProductionData&#34;.CurrentStep := 4; END_IF; 4: // åŠ å·¥å®Œæˆ IF &#34;Process_Complete&#34; AND TimerValue = T#0S THEN &#34;Lifting_Cylinder&#34; := FALSE; &#34;Servo_Home&#34; := TRUE; TimerValue := T#2S; &#34;ProductionData&#34;.CurrentStep := 5; END_IF; 5: // å¤ä½åˆ°åˆå§‹çŠ¶æ€ IF &#34;Lift_Down_Position&#34; AND &#34;Servo_Home_Position&#34; THEN &#34;ProductionData&#34;.CurrentStep := 0; &#34;ProductionData&#34;.PartCount := &#34;ProductionData&#34;.PartCount &#43; 1; SequenceComplete := TRUE; END_IF; END_CASE; // å®šæ—¶å™¨å¤„ç† IF TimerValue &gt; T#0S THEN TimerValue := TimerValue - T#1CYCLE; END_IF; // æ€¥åœå¤„ç† IF EmergencyStop THEN &#34;Conveyor_Motor&#34; := FALSE; &#34;Lifting_Cylinder&#34; := FALSE; &#34;Servo_Positioning&#34; := FALSE; &#34;Processing_Station&#34; := FALSE; &#34;ProductionData&#34;.CurrentStep := 0; END_IF; END_FUNCTION æ•…éšœè¯Šæ–­åŠŸèƒ½ (FC102) FUNCTION &#34;Diagnostics&#34; : VOID VAR_INPUT END_VAR VAR_OUTPUT AlarmText : STRING[80]; AlarmLevel : INT; END_VAR VAR ErrorCode : WORD; END_VAR BEGIN // ç”µæœºè¿‡çƒ­æ£€æµ‹ IF &#34;Motor_Temperature&#34; &gt; 80.0 THEN ErrorCode := 16#0001; AlarmLevel := 2; // è­¦å‘Š AlarmText := &#39;Motor temperature warning: Over 80Â°C&#39;; ELSIF &#34;Motor_Temperature&#34; &gt; 90.0 THEN ErrorCode := 16#0002; AlarmLevel := 3; // ä¸¥é‡æ•…éšœ AlarmText := &#39;Motor overheat fault: System shutdown required&#39;; &#34;Emergency_Stop&#34; := TRUE; END_IF; // æ°”å‹æ£€æµ‹ IF &#34;Air_Pressure&#34; &lt; 5.0 THEN ErrorCode := 16#0010; AlarmLevel := 2; AlarmText := &#39;Low air pressure: Check pneumatic system&#39;; END_IF; // ä¼ æ„Ÿå™¨æ•…éšœæ£€æµ‹ IF NOT &#34;Sensor_Signal_OK&#34; THEN ErrorCode := 16#0020; AlarmLevel := 2; AlarmText := &#39;Sensor communication fault: Check connections&#39;; END_IF; // æ€¥åœæŒ‰é’®çŠ¶æ€ IF &#34;Emergency_Stop_Pressed&#34; THEN ErrorCode := 16#00FF; AlarmLevel := 3; AlarmText := &#39;EMERGENCY STOP ACTIVATED&#39;; END_IF; // å†™å…¥æŠ¥è­¦å†å² IF ErrorCode &lt;&gt; 16#0000 THEN &#34;AlarmHistory&#34;.Write( Timestamp := CURRENT_TIME, Code := ErrorCode, Level := AlarmLevel, Message := AlarmText ); END_IF; END_FUNCTION ğŸ–¥ï¸ HMIç•Œé¢è®¾è®¡ ä¸»ç›‘æ§ç”»é¢ ç”»é¢å¸ƒå±€ (TP1200 12è‹±å¯¸): â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ç”Ÿäº§çŠ¶æ€ç›‘æ§ â”‚ æŠ¥è­¦ä¿¡æ¯ â”‚ â”‚ â”‚ â”‚ â”‚ â— è‡ªåŠ¨æ¨¡å¼ â”‚ ğŸŸ¢ æ­£å¸¸ â”‚ â”‚ â— è¿è¡Œä¸­ â”‚ ğŸŸ¡ è­¦å‘Š â”‚ â”‚ â— äº§é‡: 1,247ä»¶ â”‚ ğŸ”´ æ•…éšœ â”‚ â”‚ â— æ•ˆç‡: 98.5% â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ è®¾å¤‡çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ä¼ é€å¸¦â”‚ â”‚æå‡æœºâ”‚ â”‚ä¼ºæœ â”‚ â”‚åŠ å·¥ç«™â”‚ â”‚ â”‚ â”‚è¿è¡Œä¸­â”‚ â”‚ä¸Šå‡ â”‚ â”‚å®šä½ â”‚ â”‚åŠ å·¥ä¸­â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ æ§åˆ¶æŒ‰é’®åŒºåŸŸ â”‚ â”‚ [å¯åŠ¨] [åœæ­¢] [å¤ä½] [æ€¥åœ] â”‚ â”‚ [è‡ªåŠ¨æ¨¡å¼] [æ‰‹åŠ¨æ¨¡å¼] [å‚æ•°è®¾ç½®] â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ å®æ—¶æ•°æ®æ˜¾ç¤º â”‚ â”‚ æ¸©åº¦: 45.2Â°C å‹åŠ›: 6.8 Bar â”‚ â”‚ å¾ªç¯æ—¶é—´: 5.2s OEE: 94.3% â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å‚æ•°è®¾ç½®ç•Œé¢ // HMIè„šæœ¬ç¤ºä¾‹ - å‚æ•°éªŒè¯ FUNCTION &#34;ValidateParameters&#34; : BOOL VAR_INPUT NewSpeed : REAL; NewPosition : DINT; NewTemperature : REAL; END_VAR VAR ValidParameters : BOOL := TRUE; END_VAR BEGIN // é€Ÿåº¦å‚æ•°éªŒè¯ (0-100%) IF NewSpeed &lt; 0.0 OR NewSpeed &gt; 100.0 THEN &#34;HMI_Alarm&#34; := 16#0101; ValidParameters := FALSE; END_IF; // ä½ç½®å‚æ•°éªŒè¯ (0-5000mm) IF NewPosition &lt; 0 OR NewPosition &gt; 5000 THEN &#34;HMI_Alarm&#34; := 16#0102; ValidParameters := FALSE; END_IF; // æ¸©åº¦å‚æ•°éªŒè¯ (0-150Â°C) IF NewTemperature &lt; 0.0 OR NewTemperature &gt; 150.0 THEN &#34;HMI_Alarm&#34; := 16#0103; ValidParameters := FALSE; END_IF; ValidateParameters := ValidParameters; END_FUNCTION ğŸ“Š æ•°æ®è®°å½•ä¸åˆ†æ ç”Ÿäº§æ•°æ®è®°å½• // ç”Ÿäº§æ•°æ®è®°å½•åŠŸèƒ½ FUNCTION &#34;LogProductionData&#34; : VOID VAR_INPUT END_VAR VAR DataRecord : STRUCT Timestamp : DATE_AND_TIME; PartCount : DINT; CycleTime : TIME; QualityCount : DINT; RejectCount : DINT; END_STRUCT; END_VAR BEGIN // æ¯å°æ—¶è®°å½•ä¸€æ¬¡ç”Ÿäº§æ•°æ® IF &#34;Timer_Hourly&#34;.Q THEN DataRecord.Timestamp := CURRENT_TIME; DataRecord.PartCount := &#34;ProductionData&#34;.PartCount; DataRecord.CycleTime := &#34;Current_CycleTime&#34;; DataRecord.QualityCount := &#34;QualityParts&#34;; DataRecord.RejectCount := &#34;RejectParts&#34;; // å†™å…¥æ•°æ®æ—¥å¿— &#34;ProductionLog&#34;.Write(DataRecord); // é‡ç½®å°æ—¶è®¡æ•°å™¨ &#34;Timer_Hourly&#34;.RESET := TRUE; END_IF; END_FUNCTION OEEè®¡ç®— // è®¾å¤‡ç»¼åˆæ•ˆç‡è®¡ç®— FUNCTION &#34;CalculateOEE&#34; : REAL VAR_INPUT PlannedProductionTime : TIME; ActualProductionTime : TIME; IdealCycleTime : TIME; TotalParts : DINT; GoodParts : DINT; END_VAR VAR Availability : REAL; Performance : REAL; Quality : REAL; END_VAR BEGIN // å¯ç”¨ç‡ = å®é™…è¿è¡Œæ—¶é—´ / è®¡åˆ’ç”Ÿäº§æ—¶é—´ Availability := TIME_TO_REAL(ActualProductionTime) / TIME_TO_REAL(PlannedProductionTime); // æ€§èƒ½ç‡ = (ç†æƒ³å¾ªç¯æ—¶é—´ Ã— æ€»äº§é‡) / å®é™…è¿è¡Œæ—¶é—´ Performance := (TIME_TO_REAL(IdealCycleTime) * DINT_TO_REAL(TotalParts)) / TIME_TO_REAL(ActualProductionTime); // è´¨é‡ç‡ = åˆæ ¼å“æ•°é‡ / æ€»äº§é‡ Quality := DINT_TO_REAL(GoodParts) / DINT_TO_REAL(TotalParts); // OEE = å¯ç”¨ç‡ Ã— æ€§èƒ½ç‡ Ã— è´¨é‡ç‡ CalculateOEE := Availability * Performance * Quality; END_FUNCTION ğŸ”§ å®‰è£…è°ƒè¯•è¿‡ç¨‹ ç³»ç»Ÿè°ƒè¯•æ­¥éª¤ ç¡¬ä»¶æ£€æŸ¥ (2å¤©)
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-11-12 10:00:00 +0800 CST'>2025-11-12</span>&nbsp;Â·&nbsp;<span>5 min</span>&nbsp;Â·&nbsp;<span>937 words</span>&nbsp;Â·&nbsp;<span>dmk69</span></footer>
  <a class="entry-link" aria-label="post link to æ™ºèƒ½ç”Ÿäº§çº¿æ§åˆ¶ç³»ç»Ÿ" href="http://localhost:1313/projects/plc-production-line/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=800&amp;h=400&amp;fit=crop" alt="å·¥å‚è‡ªåŠ¨åŒ–ç›‘æ§ç³»ç»Ÿ">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">å·¥å‚è‡ªåŠ¨åŒ–ç›‘æ§ç³»ç»Ÿ
    </h2>
  </header>
  <div class="entry-content">
    <p>ğŸ­ é¡¹ç›®æ¦‚è¿° è¿™æ˜¯ä¸€ä¸ªåŸºäºAllen-Bradley ControlLogix PLCå’ŒFactoryTalk View SEçš„å·¥å‚è‡ªåŠ¨åŒ–ç›‘æ§ç³»ç»Ÿï¼Œå®ç°äº†å¯¹æ•´ä¸ªå·¥å‚ç”Ÿäº§åŒºåŸŸçš„é›†ä¸­ç›‘æ§å’Œæ•°æ®é‡‡é›†ã€‚ç³»ç»Ÿè¦†ç›–äº†åŸæ–™å¤„ç†ã€ç”Ÿäº§åˆ¶é€ ã€è´¨é‡æ£€æµ‹ã€ä»“å‚¨ç‰©æµç­‰å…¨æµç¨‹ã€‚
ğŸ¯ é¡¹ç›®ç›®æ ‡ å»ºç«‹ç»Ÿä¸€çš„å·¥å‚ç›‘æ§å¹³å° å®ç°ç”Ÿäº§æ•°æ®å®æ—¶é‡‡é›†å’Œåˆ†æ æé«˜è®¾å¤‡åˆ©ç”¨ç‡å’Œç”Ÿäº§æ•ˆç‡ å»ºç«‹é¢„è­¦å’ŒæŠ¥è­¦æœºåˆ¶ æ”¯æŒç§»åŠ¨ç«¯è¿œç¨‹ç›‘æ§ ğŸ”§ ç³»ç»Ÿæ¶æ„ ç¡¬ä»¶ç½‘ç»œæ¶æ„ å·¥å‚ç½‘ç»œæ‹“æ‰‘: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ControlLogix L73æ§åˆ¶å™¨ â”‚ â”‚ (ä¸»PLC - 1756-L73) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ EtherNet/IP (å†—ä½™ç¯ç½‘) â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚ åŸæ–™å¤„ç†åŒº â”‚ â”‚ ç”Ÿäº§åˆ¶é€ åŒº â”‚ â”‚ è´¨é‡æ£€æµ‹åŒº â”‚ â”‚ ä»“å‚¨ç‰©æµåŒº â”‚ â”‚ CompactLogixâ”‚ â”‚ ControlLogixâ”‚ â”‚ CompactLogixâ”‚ â”‚ MicroLogix â”‚ â”‚ 1769-L30ER â”‚ â”‚ 1756-L72 â”‚ â”‚ 1769-L30ER â”‚ â”‚ 1769-L33ER â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚ SCADAæœåŠ¡å™¨ â”‚ â”‚ HMIå·¥ä½œç«™ â”‚ â”‚ FactoryTalk â”‚ â”‚ PanelView Plusâ”‚ â”‚ View SE â”‚ â”‚ 1500 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ PLCé…ç½®æ¸…å• æ§åˆ¶å™¨é…ç½®: ä¸»æ§åˆ¶å™¨ (1å°): - Allen-Bradley 1756-L73 (ControlLogix) - 1756-EN2T (EtherNet/IPæ¨¡å—) - 1756-IR6I (6é€šé“RTDè¾“å…¥) - 1756-OF4 (4é€šé“æ¨¡æ‹Ÿé‡è¾“å‡º) åŒºåŸŸæ§åˆ¶å™¨ (4å°): - åŸæ–™å¤„ç†åŒº: 1769-L30ER &#43; 1769-IQ16 &#43; 1769-OB8 - ç”Ÿäº§åˆ¶é€ åŒº: 1756-L72 &#43; 1756-IB16 &#43; 1756-OW16I - è´¨é‡æ£€æµ‹åŒº: 1769-L30ER &#43; 1769-IF4 &#43; 1769-OF2 - ä»“å‚¨ç‰©æµåŒº: 1769-L33ER &#43; 1769-IQ32 HMIè®¾å¤‡ (3å°): - PanelView Plus 1500 (15å¯¸å½©è‰²è§¦æ‘¸å±) - PanelView Plus 1000 (10å¯¸æ“ä½œé¢æ¿) - ç§»åŠ¨å¹³æ¿ç”µè„‘ (æ— çº¿HMI) ğŸ’» PLCç¨‹åºå¼€å‘ ä¸»æ§åˆ¶ç¨‹åºç»“æ„ // ä¸»ç¨‹åº - MainProgram PROGRAM MainProgram VAR // ç³»ç»ŸçŠ¶æ€å˜é‡ SystemMode : DINT := 0; // 0=åœæ­¢, 1=æ‰‹åŠ¨, 2=è‡ªåŠ¨, 3=ç»´æŠ¤ EmergencyActive : BOOL := FALSE; ProductionRunning : BOOL := FALSE; // ç”Ÿäº§ç»Ÿè®¡ TotalProduction : DINT := 0; ShiftProduction : DINT := 0; HourlyProduction : ARRAY[0..23] OF DINT; // æŠ¥è­¦ç³»ç»Ÿ AlarmArray : ARRAY[1..100] OF AlarmStruct; AlarmCount : DINT := 0; // é€šä¿¡æ•°æ® SCADA_Data : SCADA_DataStruct; HMI_Commands : HMI_CommandStruct; END_VAR // ä¸»å¾ªç¯é€»è¾‘ IF SystemMode = 2 THEN // è‡ªåŠ¨æ¨¡å¼ // æ‰§è¡Œç”Ÿäº§åºåˆ— ExecuteProductionSequence(); // æ›´æ–°ç”Ÿäº§æ•°æ® UpdateProductionData(); // æ£€æŸ¥æŠ¥è­¦æ¡ä»¶ CheckAlarmConditions(); ELSIF SystemMode = 1 THEN // æ‰‹åŠ¨æ¨¡å¼ ExecuteManualCommands(); ELSIF SystemMode = 3 THEN // ç»´æŠ¤æ¨¡å¼ MaintenanceProcedures(); END_IF; // æ•°æ®é€šä¿¡å¤„ç† HandleSCADACommunication(); UpdateHMI_Display(); // æ€¥åœå¤„ç† IF EmergencyActive THEN EmergencyShutdown(); END_IF ç”Ÿäº§åºåˆ—æ§åˆ¶ // ç”Ÿäº§åºåˆ—æ§åˆ¶å‡½æ•° FUNCTION ExecuteProductionSequence : VOID VAR_INPUT END_VAR VAR CurrentStep : DINT := 0; StepTimer : TIMER; END_VAR BEGIN CASE CurrentStep OF 0: // åˆå§‹çŠ¶æ€ IF HMI_Commands.StartButton THEN CurrentStep := 10; StepTimer.PRE := 3000; // 3ç§’ StepTimer.IN := TRUE; END_IF; 10: // åŸæ–™å‡†å¤‡ IF RawMaterialReady AND StepTimer.DN THEN CurrentStep := 20; StartConveyor(CONVEYOR_FEEDER); StepTimer.PRE := 5000; // 5ç§’ StepTimer.IN := TRUE; END_IF; 20: // ç‰©æ–™è¾“é€ IF MaterialAtPosition(STATION_1) AND StepTimer.DN THEN CurrentStep := 30; StopConveyor(CONVEYOR_FEEDER); StartProcessing(STATION_1); StepTimer.PRE := 15000; // 15ç§’ StepTimer.IN := TRUE; END_IF; 30: // åŠ å·¥å¤„ç† IF ProcessComplete(STATION_1) AND StepTimer.DN THEN CurrentStep := 40; StartConveyor(CONVEYOR_MAIN); MoveToNextStation(); StepTimer.PRE := 8000; // 8ç§’ StepTimer.IN := TRUE; END_IF; 40: // è´¨é‡æ£€æµ‹ IF AtQualityStation() AND StepTimer.DN THEN CurrentStep := 50; StopConveyor(CONVEYOR_MAIN); StartQualityCheck(); StepTimer.PRE := 10000; // 10ç§’ StepTimer.IN := TRUE; END_IF; 50: // ç»“æœå¤„ç† IF QualityCheckComplete() AND StepTimer.DN THEN IF QualityPass THEN // åˆæ ¼å“ - è¿›å…¥åŒ…è£…æµç¨‹ CurrentStep := 60; StartPackaging(); ELSE // ä¸åˆæ ¼å“ - è¿›å…¥è¿”å·¥æµç¨‹ CurrentStep := 70; StartReworkProcess(); END_IF; StepTimer.PRE := 5000; StepTimer.IN := TRUE; END_IF; 60: // åŒ…è£…å®Œæˆ IF PackagingComplete() AND StepTimer.DN THEN CurrentStep := 0; TotalProduction := TotalProduction &#43; 1; ShiftProduction := ShiftProduction &#43; 1; HourlyProduction[GetCurrentHour()] := HourlyProduction[GetCurrentHour()] &#43; 1; END_IF; 70: // è¿”å·¥å¤„ç† IF ReworkComplete() AND StepTimer.DN THEN CurrentStep := 20; // è¿”å›åˆ°åŠ å·¥æ­¥éª¤ END_IF; END_CASE; // æ€¥åœå¤„ç† IF EmergencyActive THEN StopAllEquipment(); CurrentStep := 0; END_IF; END_FUNCTION æ•°æ®è®°å½•åŠŸèƒ½ // ç”Ÿäº§æ•°æ®è®°å½• FUNCTION LogProductionData : VOID VAR_INPUT END_VAR VAR DataRecord : ProductionRecord; CurrentTime : DT; END_VAR BEGIN // è·å–å½“å‰æ—¶é—´ CurrentTime := GetSystemTime(); // æ„å»ºæ•°æ®è®°å½• DataRecord.Timestamp := CurrentTime; DataRecord.ShiftID := GetCurrentShift(); DataRecord.ProductID := CurrentProductID; DataRecord.Quantity := ShiftProduction; DataRecord.QualityPassRate := CalculateQualityRate(); DataRecord.EquipmentUtilization := CalculateOEE(); DataRecord.EnergyConsumption := GetTotalEnergyUsage(); // å†™å…¥æ•°æ®ç¼“å†²åŒº ProductionLogBuffer.Write(DataRecord); // æ¯å°æ—¶å‘SCADAå‘é€ä¸€æ¬¡æ±‡æ€»æ•°æ® IF IsHourBoundary() THEN SendHourlyDataToSCADA(); END_IF; END_FUNCTION ğŸ–¥ï¸ SCADAç³»ç»Ÿå¼€å‘ FactoryTalk View SEé…ç½® åº”ç”¨ç»“æ„: FactoryTalk SE Application â”œâ”€â”€ Area Models â”‚ â”œâ”€â”€ Raw_Material_Area (åŸæ–™å¤„ç†åŒº) â”‚ â”œâ”€â”€ Production_Area (ç”Ÿäº§åˆ¶é€ åŒº) â”‚ â”œâ”€â”€ Quality_Area (è´¨é‡æ£€æµ‹åŒº) â”‚ â””â”€â”€ Logistics_Area (ä»“å‚¨ç‰©æµåŒº) â”œâ”€â”€ HMI Displays â”‚ â”œâ”€â”€ Main_Overview (ä¸»ç›‘æ§ç”»é¢) â”‚ â”œâ”€â”€ Production_Detail (ç”Ÿäº§è¯¦æƒ…) â”‚ â”œâ”€â”€ Alarm_Display (æŠ¥è­¦æ˜¾ç¤º) â”‚ â”œâ”€â”€ Trend_Display (è¶‹åŠ¿å›¾) â”‚ â””â”€â”€ Report_Display (æŠ¥è¡¨ç”»é¢) â”œâ”€â”€ Data Logs â”‚ â”œâ”€â”€ Production_Log (ç”Ÿäº§æ•°æ®) â”‚ â”œâ”€â”€ Alarm_Log (æŠ¥è­¦è®°å½•) â”‚ â””â”€â”€ Energy_Log (èƒ½è€—æ•°æ®) â””â”€â”€ Security â”œâ”€â”€ Operator (æ“ä½œå‘˜æƒé™) â”œâ”€â”€ Supervisor (ä¸»ç®¡æƒé™) â””â”€â”€ Engineer (å·¥ç¨‹å¸ˆæƒé™) ä¸»ç›‘æ§ç”»é¢è®¾è®¡ ä¸»ç”»é¢å¸ƒå±€ (1920Ã—1080åˆ†è¾¨ç‡): â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ ‡é¢˜æ : å·¥å‚è‡ªåŠ¨åŒ–ç›‘æ§ç³»ç»Ÿ â”‚ ç”¨æˆ·: æ“ä½œå‘˜ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ åŒºåŸŸé€‰æ‹©æ ‡ç­¾: [åŸæ–™åŒº] [ç”Ÿäº§åŒº] [è´¨é‡åŒº] [ä»“å‚¨åŒº] [æ€»è§ˆ] â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ åŸæ–™å¤„ç†åŒº â”‚ â”‚ ç”Ÿäº§åˆ¶é€ åŒº â”‚ â”‚ è´¨é‡æ£€æµ‹åŒº â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ ğŸŸ¢ æ­£å¸¸è¿è¡Œ â”‚ â”‚ ğŸŸ¡ æ€§èƒ½ä¸‹é™ â”‚ â”‚ ğŸŸ¢ æ­£å¸¸è¿è¡Œ â”‚ â”‚ â”‚ â”‚ äº§é‡: 245å¨ â”‚ â”‚ äº§é‡: 1,847ä»¶ â”‚ â”‚ åˆæ ¼ç‡: 99.2% â”‚ â”‚ â”‚ â”‚ æ•ˆç‡: 94.5% â”‚ â”‚ OEE: 87.3% â”‚ â”‚ æ£€æµ‹: 1,823ä»¶ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ [è¯¦ç»†ä¿¡æ¯] â”‚ â”‚ [è¯¦ç»†ä¿¡æ¯] â”‚ â”‚ [è¯¦ç»†ä¿¡æ¯] â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ å®æ—¶è¶‹åŠ¿å›¾ (æœ€è¿‘1å°æ—¶): â”‚ â”‚ äº§é‡æ›²çº¿: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â”‚ è´¨é‡æ›²çº¿: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â”‚ æ•ˆç‡æ›²çº¿: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ åº•éƒ¨çŠ¶æ€æ : æŠ¥è­¦æ•°: 2 | ç³»ç»ŸçŠ¶æ€: æ­£å¸¸ | å½“å‰æ—¶é—´: 14:35: â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ VBAè„šæœ¬ - æ•°æ®å¯¼å‡ºåŠŸèƒ½ &#39; å¯¼å‡ºç”Ÿäº§æŠ¥è¡¨åˆ°Excel Sub ExportProductionReport() Dim excelApp As Object Dim workbook As Object Dim worksheet As Object Dim reportData As Variant Dim i As Integer &#39; åˆ›å»ºExcelåº”ç”¨ç¨‹åº Set excelApp = CreateObject(&#34;Excel.Application&#34;) Set workbook = excelApp.Workbooks.Add Set worksheet = workbook.Worksheets(1) &#39; è®¾ç½®è¡¨å¤´ worksheet.Cells(1, 1).Value = &#34;æ—¶é—´&#34; worksheet.Cells(1, 2).Value = &#34;äº§é‡&#34; worksheet.Cells(1, 3).Value = &#34;åˆæ ¼ç‡&#34; worksheet.Cells(1, 4).Value = &#34;OEE&#34; worksheet.Cells(1, 5).Value = &#34;èƒ½è€—&#34; &#39; ä»FactoryTalkæ•°æ®æ¨¡å‹è·å–æ•°æ® For i = 0 To 23 worksheet.Cells(i &#43; 2, 1).Value = FormatHour(i) worksheet.Cells(i &#43; 2, 2).Value = HourlyProduction(i) worksheet.Cells(i &#43; 2, 3).Value = HourlyQualityRate(i) worksheet.Cells(i &#43; 2, 4).Value = HourlyOEE(i) worksheet.Cells(i &#43; 2, 5).Value = HourlyEnergy(i) Next i &#39; æ ¼å¼åŒ–è¡¨æ ¼ worksheet.Columns(&#34;A:E&#34;).AutoFit worksheet.Range(&#34;A1:E1&#34;).Font.Bold = True &#39; ä¿å­˜æ–‡ä»¶ Dim fileName As String fileName = &#34;Production_Report_&#34; &amp; Format(Now, &#34;yyyymmdd&#34;) &amp; &#34;.xlsx&#34; workbook.SaveAs fileName workbook.Close excelApp.Quit Set excelApp = Nothing &#39; æ˜¾ç¤ºå¯¼å‡ºæˆåŠŸæ¶ˆæ¯ MsgBox &#34;ç”Ÿäº§æŠ¥è¡¨å·²å¯¼å‡ºè‡³: &#34; &amp; fileName, vbInformation, &#34;å¯¼å‡ºå®Œæˆ&#34; End Sub ğŸ“Š æ•°æ®åˆ†æä¸æŠ¥è¡¨ ç”Ÿäº§KPIè®¡ç®— // å…³é”®æ€§èƒ½æŒ‡æ ‡è®¡ç®— FUNCTION CalculateKPIs : KPI_Struct VAR_INPUT ShiftData : Shift_Data_Struct; END_VAR VAR_OUTPUT Result : KPI_Struct; END_VAR VAR PlannedProductionTime : REAL; ActualProductionTime : REAL; IdealCycleTime : REAL; END_VAR BEGIN // è®¡åˆ’ç”Ÿäº§æ—¶é—´ (å°æ—¶) PlannedProductionTime := 8.0; // 8å°æ—¶ç­æ¬¡ // å®é™…ç”Ÿäº§æ—¶é—´ (è€ƒè™‘åœæœºæ—¶é—´) ActualProductionTime := PlannedProductionTime - (ShiftData.Downtime.Total / 3600.0); // ç†æƒ³å¾ªç¯æ—¶é—´ (ç§’/ä»¶) IdealCycleTime := 45.0; // 45ç§’ç”Ÿäº§ä¸€ä»¶ // å¯ç”¨ç‡ (Availability) Result.Availability := ActualProductionTime / PlannedProductionTime; // æ€§èƒ½ç‡ (Performance) Result.Performance := (IdealCycleTime * ShiftData.TotalParts) / (ActualProductionTime * 3600.0); // è´¨é‡ç‡ (Quality) IF ShiftData.TotalParts &gt; 0 THEN Result.Quality := ShiftData.GoodParts / ShiftData.TotalParts; ELSE Result.Quality := 0.0; END_IF; // OEE (Overall Equipment Effectiveness) Result.OEE := Result.Availability * Result.Performance * Result.Quality; // äº§é‡è¾¾æˆç‡ Result.ProductionRate := ShiftData.TotalParts / ShiftData.TargetProduction; // èƒ½è€—æŒ‡æ ‡ Result.EnergyPerUnit := ShiftData.TotalEnergy / ShiftData.TotalParts; END_FUNCTION å®æ—¶æ•°æ®è¶‹åŠ¿å›¾ // è¶‹åŠ¿æ•°æ®ç¼“å­˜ FUNCTION_BUFFER TrendDataBuffer VAR_INPUT NewValue : REAL; Timestamp : DT; END_VAR VAR DataArray : ARRAY[1..1000] OF REAL; TimeArray : ARRAY[1..1000] OF DT; Index : DINT := 0; BufferSize : DINT := 1000; END_VAR BEGIN // æ›´æ–°ç´¢å¼• Index := (Index MOD BufferSize) &#43; 1; // å­˜å‚¨æ–°æ•°æ® DataArray[Index] := NewValue; TimeArray[Index] := Timestamp; // è¾“å‡ºæœ€è¿‘Nä¸ªæ•°æ®ç‚¹ç»™SCADA SCADA_TrendData := GetRecentDataPoints(100); END_FUNCTION_BUFFER ğŸ”§ ç§»åŠ¨ç«¯ç›‘æ§ Web HMIç•Œé¢ ç§»åŠ¨ç«¯ç›‘æ§ç•Œé¢ (å“åº”å¼è®¾è®¡): â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ğŸ­ å·¥å‚ç›‘æ§ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ ğŸ“Š ä»Šæ—¥ç”Ÿäº§æ¦‚å†µ â”‚ â”‚ ç›®æ ‡: 2,000ä»¶ â”‚ â”‚ å®é™…: 1,847ä»¶ (92.4%) â”‚ â”‚ åˆæ ¼: 1,832ä»¶ (99.2%) â”‚ â”‚ â”‚ â”‚ ğŸ“ˆ å„åŒºåŸŸçŠ¶æ€ â”‚ â”‚ åŸæ–™åŒº: ğŸŸ¢ æ­£å¸¸ â”‚ â”‚ ç”Ÿäº§åŒº: ğŸŸ¡ æ•ˆç‡85% â”‚ â”‚ è´¨æ£€åŒº: ğŸŸ¢ æ­£å¸¸ â”‚ â”‚ ä»“å‚¨åŒº: ğŸŸ¢ æ­£å¸¸ â”‚ â”‚ â”‚ â”‚ âš ï¸ å½“å‰æŠ¥è­¦ â”‚ â”‚ â€¢ ç”Ÿäº§åŒºæ•ˆç‡ä¸‹é™ â”‚ â”‚ â€¢ 3å·è®¾å¤‡éœ€ç»´æŠ¤ â”‚ â”‚ â”‚ â”‚ ğŸ“± å¿«é€Ÿæ“ä½œ â”‚ â”‚ [æŸ¥çœ‹è¯¦æƒ…] [å¯¼å‡ºæŠ¥è¡¨] â”‚ â”‚ [æŠ¥è­¦ç¡®è®¤] [è”ç³»æ”¯æŒ] â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ğŸ“ˆ é¡¹ç›®æˆæœ æŠ€æœ¯æˆæœ ç›‘æ§è¦†ç›–èŒƒå›´: 4ä¸ªç”Ÿäº§åŒºåŸŸï¼Œ32å°è®¾å¤‡ æ•°æ®é‡‡é›†ç‚¹: 500&#43;ä¸ªå®æ—¶ç›‘æ§ç‚¹ æŠ¥è­¦å“åº”æ—¶é—´: &lt; 2ç§’ å†å²æ•°æ®å­˜å‚¨: 3å¹´å®Œæ•´æ•°æ® ç§»åŠ¨ç«¯è®¿é—®: æ”¯æŒiOS/Androidè®¾å¤‡ ç®¡ç†æ•ˆç›Š ç”Ÿäº§é€æ˜åº¦: å®æ—¶æŒæ¡å…¨å‚ç”Ÿäº§çŠ¶å†µ å†³ç­–æ”¯æŒ: åŸºäºæ•°æ®çš„ç®¡ç†å†³ç­– å¼‚å¸¸å“åº”: å¿«é€Ÿå‘ç°å’Œå¤„ç†ç”Ÿäº§å¼‚å¸¸ æˆæœ¬æ§åˆ¶: ç²¾ç»†åŒ–çš„èƒ½è€—å’Œææ–™ç®¡ç† è´¨é‡æå‡: å®æ—¶è´¨é‡ç›‘æ§å’Œè¿½æº¯ æŠ•èµ„å›æŠ¥ å®æ–½å‘¨æœŸ: 6ä¸ªæœˆ æŠ•èµ„é‡‘é¢: 280ä¸‡å…ƒ å¹´æ”¶ç›Š: 450ä¸‡å…ƒ æŠ•èµ„å›æ”¶æœŸ: 7.5ä¸ªæœˆ ğŸ“ æŠ€æœ¯ç‰¹è‰² åˆ†å¸ƒå¼æ§åˆ¶æ¶æ„: å¤šPLCååŒå·¥ä½œï¼Œæé«˜ç³»ç»Ÿå¯é æ€§ å†—ä½™ç½‘ç»œè®¾è®¡: ç¯ç½‘æ‹“æ‰‘ï¼Œå•ç‚¹æ•…éšœä¸å½±å“ç³»ç»Ÿè¿è¡Œ å®æ—¶æ•°æ®é‡‡é›†: æ¯«ç§’çº§æ•°æ®æ›´æ–°ï¼Œå‡†ç¡®åæ˜ ç”Ÿäº§çŠ¶æ€ æ™ºèƒ½æŠ¥è­¦ç³»ç»Ÿ: åˆ†çº§æŠ¥è­¦ç®¡ç†ï¼Œé‡è¦ä¿¡æ¯åŠæ—¶æ¨é€ ç§»åŠ¨åŒ–æ”¯æŒ: éšæ—¶éšåœ°çš„ç”Ÿäº§ç›‘æ§èƒ½åŠ› è¯¥é¡¹ç›®å±•ç¤ºäº†ç°ä»£å·¥å‚è‡ªåŠ¨åŒ–ç›‘æ§ç³»ç»Ÿçš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œä»ç¡¬ä»¶é€‰å‹åˆ°è½¯ä»¶å¼€å‘ï¼Œä»æ•°æ®å¤„ç†åˆ°ç”¨æˆ·ç•Œé¢çš„å…¨æ–¹ä½æŠ€æœ¯èƒ½åŠ›ã€‚
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-11-12 11:00:00 +0800 CST'>2025-11-12</span>&nbsp;Â·&nbsp;<span>6 min</span>&nbsp;Â·&nbsp;<span>1233 words</span>&nbsp;Â·&nbsp;<span>dmk69</span></footer>
  <a class="entry-link" aria-label="post link to å·¥å‚è‡ªåŠ¨åŒ–ç›‘æ§ç³»ç»Ÿ" href="http://localhost:1313/projects/factory-automation/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&amp;h=400&amp;fit=crop" alt="æ™ºèƒ½è®¾å¤‡æ§åˆ¶å•å…ƒ">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">æ™ºèƒ½è®¾å¤‡æ§åˆ¶å•å…ƒ
    </h2>
  </header>
  <div class="entry-content">
    <p>ğŸ”§ é¡¹ç›®æ¦‚è¿° è¿™æ˜¯ä¸€ä¸ªåŸºäºSTM32F4ç³»åˆ—å¾®æ§åˆ¶å™¨çš„æ™ºèƒ½è®¾å¤‡æ§åˆ¶å•å…ƒï¼Œä¸“é—¨ç”¨äºå·¥ä¸šç°åœºçš„æ•°æ®é‡‡é›†ã€è®¾å¤‡æ§åˆ¶å’Œæ•°æ®é€šä¿¡ã€‚è¯¥æ§åˆ¶å•å…ƒé›†æˆäº†å¤šç§å·¥ä¸šä¼ æ„Ÿå™¨ï¼Œæ”¯æŒModbus RTU/TCPé€šä¿¡åè®®ï¼Œå¯ä½œä¸ºPLCç³»ç»Ÿçš„è¡¥å……æ§åˆ¶å™¨æˆ–ç‹¬ç«‹çš„ç›‘æ§èŠ‚ç‚¹ä½¿ç”¨ã€‚
ğŸ¯ é¡¹ç›®ç›®æ ‡ å®ç°å¤šä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†å’Œé¢„å¤„ç† æä¾›æœ¬åœ°æ§åˆ¶å’Œä¿æŠ¤åŠŸèƒ½ æ”¯æŒModbuså·¥ä¸šé€šä¿¡åè®® å…·å¤‡æ•°æ®è®°å½•å’Œæ•…éšœè¯Šæ–­èƒ½åŠ› æ»¡è¶³å·¥ä¸šç¯å¢ƒçš„å¯é æ€§è¦æ±‚ ğŸ”§ ç¡¬ä»¶æ¶æ„ STM32æ§åˆ¶æ¿è®¾è®¡ ç¡¬ä»¶é…ç½®: ä¸»æ§åˆ¶å™¨: â”œâ”€â”€ STM32F407VGT6 (ARM Cortex-M4, 168MHz) â”œâ”€â”€ 1MB Flash, 192KB RAM â”œâ”€â”€ 3Ã—UART (é€šä¿¡æ¥å£) â”œâ”€â”€ 2Ã—I2C (ä¼ æ„Ÿå™¨æ‰©å±•) â”œâ”€â”€ 3Ã—SPI (é«˜é€Ÿæ•°æ®æ¥å£) â”œâ”€â”€ 16Ã—12ä½ADC (æ¨¡æ‹Ÿé‡é‡‡é›†) â””â”€â”€ 2Ã—12ä½DAC (æ¨¡æ‹Ÿé‡è¾“å‡º) ç”µæºç®¡ç†: â”œâ”€â”€ 24V DCå·¥ä¸šç”µæºè¾“å…¥ â”œâ”€â”€ 5V/3.3V DC-DCè½¬æ¢å™¨ â”œâ”€â”€ ç”µæºæ»¤æ³¢å’Œä¿æŠ¤ç”µè·¯ â”œâ”€â”€ å¤‡ç”¨ç”µæ±  (RTCå’Œæ•°æ®ä¿æŒ) â””â”€â”€ çœ‹é—¨ç‹—å®šæ—¶å™¨ é€šä¿¡æ¥å£: â”œâ”€â”€ RS485æ¥å£ (Modbus RTU) â”œâ”€â”€ Ethernetæ¥å£ (Modbus TCP) â”œâ”€â”€ USBæ¥å£ (è°ƒè¯•å’Œé…ç½®) â”œâ”€â”€ CANæ€»çº¿æ¥å£ (è®¾å¤‡äº’è”) â””â”€â”€ WiFiæ¨¡å— (å¯é€‰æ— çº¿é€šä¿¡) ä¼ æ„Ÿå™¨æ¥å£ç”µè·¯ ä¼ æ„Ÿå™¨è¿æ¥: â”œâ”€â”€ æ¸©åº¦ä¼ æ„Ÿå™¨ (PT100) â”‚ â”œâ”€â”€ æ’æµæºæ¿€åŠ±ç”µè·¯ â”‚ â”œâ”€â”€ ä¿¡å·æ”¾å¤§å’Œæ»¤æ³¢ â”‚ â””â”€â”€ å†·ç«¯è¡¥å¿ â”œâ”€â”€ å‹åŠ›ä¼ æ„Ÿå™¨ (4-20mA) â”‚ â”œâ”€â”€ ç²¾å¯†ç”µé˜»é‡‡æ · â”‚ â”œâ”€â”€ è¿‡å‹ä¿æŠ¤ â”‚ â””â”€â”€ ä¿¡å·éš”ç¦» â”œâ”€â”€ æµé‡è®¡ (è„‰å†²è¾“å‡º) â”‚ â”œâ”€â”€ å…‰ç”µéš”ç¦»è¾“å…¥ â”‚ â”œâ”€â”€ é¢‘ç‡æµ‹é‡ç”µè·¯ â”‚ â””â”€â”€ æŠ—å¹²æ‰°æ»¤æ³¢ â””â”€â”€ æŒ¯åŠ¨ä¼ æ„Ÿå™¨ (IEPE) â”œâ”€â”€ æ’æµæºä¾›ç”µ â”œâ”€â”€ ACä¿¡å·æ”¾å¤§ â””â”€â”€ RMSè½¬æ¢ç”µè·¯ ğŸ’» è½¯ä»¶æ¶æ„ ä¸»ç¨‹åºæ¡†æ¶ /** * @file main.c * @brief æ™ºèƒ½æ§åˆ¶å•å…ƒä¸»ç¨‹åº * @author Automation Technician * @date 2025-11-12 */ #include &#34;main.h&#34; #include &#34;sensor_manager.h&#34; #include &#34;modbus_server.h&#34; #include &#34;data_logger.h&#34; #include &#34;watchdog.h&#34; #include &#34;system_config.h&#34; /* å…¨å±€å˜é‡å®šä¹‰ */ SystemStatus_t g_systemStatus; SensorData_t g_sensorData; ModbusRegisters_t g_modbusRegisters; uint32_t g_systemTick = 0; /* å‡½æ•°å£°æ˜ */ static void SystemClock_Config(void); static void GPIO_Init(void); static void Peripherals_Init(void); static void Task_SensorAcquisition(void); static void Task_DataProcessing(void); static void Task_Communication(void); static void Task_SystemMonitoring(void); /** * @brief ä¸»å‡½æ•° */ int main(void) { /* ç³»ç»Ÿåˆå§‹åŒ– */ HAL_Init(); SystemClock_Config(); GPIO_Init(); Peripherals_Init(); /* å¤–è®¾åˆå§‹åŒ– */ SensorManager_Init(); ModbusServer_Init(); DataLogger_Init(); Watchdog_Init(); /* ç³»ç»ŸçŠ¶æ€åˆå§‹åŒ– */ g_systemStatus.mode = MODE_AUTO; g_systemStatus.error_code = ERROR_NONE; g_systemStatus.uptime = 0; /* ä¸»å¾ªç¯ */ while (1) { g_systemTick = HAL_GetTick(); /* ä»»åŠ¡è°ƒåº¦ */ Task_SensorAcquisition(); // 100mså‘¨æœŸ Task_DataProcessing(); // 500mså‘¨æœŸ Task_Communication(); // å®æ—¶å¤„ç† Task_SystemMonitoring(); // 1000mså‘¨æœŸ /* å–‚ç‹— */ Watchdog_Refresh(); /* ä½åŠŸè€—å¤„ç† */ if (g_systemStatus.mode == MODE_SLEEP) { __WFI(); } } } /** * @brief ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ä»»åŠ¡ */ static void Task_SensorAcquisition(void) { static uint32_t lastAcquisitionTime = 0; /* 100msé‡‡é›†å‘¨æœŸ */ if (g_systemTick - lastAcquisitionTime &gt;= 100) { /* é‡‡é›†æ¸©åº¦æ•°æ® */ g_sensorData.temperature = SensorManager_ReadTemperature(); /* é‡‡é›†å‹åŠ›æ•°æ® */ g_sensorData.pressure = SensorManager_ReadPressure(); /* é‡‡é›†æµé‡æ•°æ® */ g_sensorData.flow_rate = SensorManager_ReadFlowRate(); /* é‡‡é›†æŒ¯åŠ¨æ•°æ® */ g_sensorData.vibration = SensorManager_ReadVibration(); /* æ›´æ–°æ•°æ®æ—¶é—´æˆ³ */ g_sensorData.timestamp = g_systemTick; lastAcquisitionTime = g_systemTick; } } /** * @brief æ•°æ®å¤„ç†ä»»åŠ¡ */ static void Task_DataProcessing(void) { static uint32_t lastProcessingTime = 0; /* 500mså¤„ç†å‘¨æœŸ */ if (g_systemTick - lastProcessingTime &gt;= 500) { /* æ•°æ®æ»¤æ³¢å¤„ç† */ DataLogger_FilterSensorData(&amp;g_sensorData); /* æ•°æ®èŒƒå›´æ£€æŸ¥ */ DataLogger_ValidateSensorData(&amp;g_sensorData); /* è®¡ç®—è¡ç”Ÿå‚æ•° */ g_sensorData.pressure_rate = DataLogger_CalculatePressureRate(); g_sensorData.flow_total = DataLogger_CalculateFlowTotal(); /* æ›´æ–°Modbuså¯„å­˜å™¨ */ ModbusServer_UpdateRegisters(&amp;g_sensorData); lastProcessingTime = g_systemTick; } } /** * @brief é€šä¿¡å¤„ç†ä»»åŠ¡ */ static void Task_Communication(void) { /* Modbus RTUé€šä¿¡å¤„ç† */ if (HAL_UART_GetState(&amp;huart1) == HAL_UART_STATE_BUSY_RX) { ModbusServer_ProcessRTU(); } /* Modbus TCPé€šä¿¡å¤„ç† */ if (HAL_ETH_GetState(&amp;heth) == HAL_ETH_STATE_BUSY_RX) { ModbusServer_ProcessTCP(); } /* USBé€šä¿¡å¤„ç† (è°ƒè¯•ç”¨) */ if (HAL_UART_GetState(&amp;huart3) == HAL_UART_STATE_BUSY_RX) { ProcessUSBCommand(); } } /** * @brief ç³»ç»Ÿç›‘æ§ä»»åŠ¡ */ static void Task_SystemMonitoring(void) { static uint32_t lastMonitorTime = 0; /* 1000msç›‘æ§å‘¨æœŸ */ if (g_systemTick - lastMonitorTime &gt;= 1000) { /* æ›´æ–°ç³»ç»Ÿè¿è¡Œæ—¶é—´ */ g_systemStatus.uptime&#43;&#43;; /* æ£€æŸ¥ç³»ç»Ÿé”™è¯¯ */ SystemError_Check(); /* ç›‘æ§ç”µæºç”µå‹ */ if (SystemMonitor_GetPowerVoltage() &lt; 20.0) { g_systemStatus.error_code |= ERROR_LOW_VOLTAGE; } /* æ£€æŸ¥å­˜å‚¨ç©ºé—´ */ if (DataLogger_GetFreeSpace() &lt; 1024) { g_systemStatus.error_code |= ERROR_STORAGE_FULL; } /* ç³»ç»ŸçŠ¶æ€LEDæŒ‡ç¤º */ SystemStatus_UpdateLED(); lastMonitorTime = g_systemTick; } } ä¼ æ„Ÿå™¨ç®¡ç†æ¨¡å— /** * @file sensor_manager.c * @brief ä¼ æ„Ÿå™¨ç®¡ç†æ¨¡å— */ #include &#34;sensor_manager.h&#34; #include &#34;adc.h&#34; #include &#34;tim.h&#34; #include &#34;i2c.h&#34; /* ä¼ æ„Ÿå™¨æ ¡å‡†å‚æ•° */ typedef struct { float offset; float scale; float filter_coefficient; } SensorCalibration_t; static SensorCalibration_t tempCalib = {0.0, 1.0, 0.1}; static SensorCalibration_t pressureCalib = {0.0, 1.0, 0.1}; /** * @brief æ¸©åº¦ä¼ æ„Ÿå™¨è¯»å– (PT100) */ float SensorManager_ReadTemperature(void) { static float filteredTemp = 25.0; uint16_t adcValue; float voltage, resistance, temperature; /* è¯»å–ADCå€¼ */ adcValue = ADC_ReadChannel(ADC_CHANNEL_TEMP); /* è½¬æ¢ä¸ºç”µå‹ */ voltage = (float)adcValue * 3.3f / 4096.0f; /* è®¡ç®—PT100ç”µé˜» */ resistance = voltage * 1000.0f / 1.0f; /* 1mAæ’æµæº */ /* PT100ç”µé˜»-æ¸©åº¦è½¬æ¢ (Callendar-Van Dusenæ–¹ç¨‹) */ if (resistance &gt;= 100.0) { temperature = -242.02 &#43; 2.2228 * resistance &#43; 0.00258 * resistance * resistance; } else { temperature = -242.02 &#43; 2.2228 * resistance; } /* åº”ç”¨æ ¡å‡†å‚æ•° */ temperature = temperature * tempCalib.scale &#43; tempCalib.offset; /* è½¯ä»¶æ»¤æ³¢ */ filteredTemp = filteredTemp * (1.0 - tempCalib.filter_coefficient) &#43; temperature * tempCalib.filter_coefficient; return filteredTemp; } /** * @brief å‹åŠ›ä¼ æ„Ÿå™¨è¯»å– (4-20mA) */ float SensorManager_ReadPressure(void) { static float filteredPressure = 0.0; uint16_t adcValue; float current, pressure; /* è¯»å–ADCå€¼ */ adcValue = ADC_ReadChannel(ADC_CHANNEL_PRESSURE); /* è½¬æ¢ä¸ºç”µæµ (4-20mAå¯¹åº”0.8-4Vç”µå‹) */ float voltage = (float)adcValue * 3.3f / 4096.0f; current = (voltage - 0.8f) * 5.0f; /* 4-20mA */ /* è½¬æ¢ä¸ºå‹åŠ›å€¼ (0-10Bar) */ pressure = (current - 4.0f) * 10.0f / 16.0f; /* 4-20mA -&gt; 0-10Bar */ /* è´Ÿå€¼å¤„ç† */ if (pressure &lt; 0.0) pressure = 0.0; /* åº”ç”¨æ ¡å‡†å‚æ•° */ pressure = pressure * pressureCalib.scale &#43; pressureCalib.offset; /* è½¯ä»¶æ»¤æ³¢ */ filteredPressure = filteredPressure * (1.0 - pressureCalib.filter_coefficient) &#43; pressure * pressureCalib.filter_coefficient; return filteredPressure; } /** * @brief æµé‡ä¼ æ„Ÿå™¨è¯»å– (è„‰å†²è¾“å‡º) */ float SensorManager_ReadFlowRate(void) { static uint32_t lastPulseCount = 0; static uint32_t lastReadTime = 0; static float flowRate = 0.0; uint32_t currentPulseCount, pulseDelta; uint32_t timeDelta; float frequency; /* è·å–å½“å‰è„‰å†²è®¡æ•° */ currentPulseCount = TIM_GetPulseCount(TIM_FLOW); /* è®¡ç®—æ—¶é—´å·® */ timeDelta = g_systemTick - lastReadTime; if (timeDelta &gt; 0) { /* è®¡ç®—è„‰å†²å¢é‡ */ pulseDelta = currentPulseCount - lastPulseCount; /* è®¡ç®—é¢‘ç‡ (Hz) */ frequency = (float)pulseDelta * 1000.0f / (float)timeDelta; /* è½¬æ¢ä¸ºæµé‡ (L/min) */ flowRate = frequency * 60.0f / 100.0f; /* 100è„‰å†²/L */ /* æ›´æ–°å†å²è®°å½• */ lastPulseCount = currentPulseCount; lastReadTime = g_systemTick; } return flowRate; } /** * @brief æŒ¯åŠ¨ä¼ æ„Ÿå™¨è¯»å– (IEPE) */ float SensorManager_ReadVibration(void) { uint16_t adcValue; float voltage, rmsValue; /* è¯»å–ADCå€¼ */ adcValue = ADC_ReadChannel(ADC_CHANNEL_VIBRATION); /* è½¬æ¢ä¸ºç”µå‹ */ voltage = (float)adcValue * 3.3f / 4096.0f; /* è®¡ç®—RMSå€¼ */ rmsValue = Vibration_CalculateRMS(voltage); /* è½¬æ¢ä¸ºåŠ é€Ÿåº¦å€¼ (g) */ float acceleration = rmsValue * 10.0f; /* 10g/Vçµæ•åº¦ */ return acceleration; } Modbusé€šä¿¡æ¨¡å— /** * @file modbus_server.c * @brief ModbusæœåŠ¡å™¨å®ç° */ #include &#34;modbus_server.h&#34; #include &#34;usart.h&#34; #include &#34;ethernet.h&#34; /* Modbuså¯„å­˜å™¨æ˜ å°„ */ typedef union { struct { uint16_t holding_registers[100]; uint16_t input_registers[100]; uint16_t coils[100]; uint16_t discrete_inputs[100]; } registers; uint16_t raw[400]; } ModbusMemoryMap_t; static ModbusMemoryMap_t g_modbusMemory; /** * @brief Modbuså¯„å­˜å™¨æ˜ å°„ */ void ModbusServer_UpdateRegisters(SensorData_t* sensorData) { /* è¾“å…¥å¯„å­˜å™¨ (åªè¯») */ g_modbusMemory.registers.input_registers[0] = (uint16_t)(sensorData-&gt;temperature * 10.0); // æ¸©åº¦ (0.1Â°C) g_modbusMemory.registers.input_registers[1] = (uint16_t)(sensorData-&gt;pressure * 100.0); // å‹åŠ› (0.01Bar) g_modbusMemory.registers.input_registers[2] = (uint16_t)(sensorData-&gt;flow_rate * 10.0); // æµé‡ (0.1L/min) g_modbusMemory.registers.input_registers[3] = (uint16_t)(sensorData-&gt;vibration * 100.0); // æŒ¯åŠ¨ (0.01g) /* ä¿æŒå¯„å­˜å™¨ (è¯»å†™) */ g_modbusMemory.registers.holding_registers[0] = (uint16_t)(g_systemStatus.mode); // è¿è¡Œæ¨¡å¼ g_modbusMemory.registers.holding_registers[1] = (uint16_t)(g_systemStatus.error_code); // é”™è¯¯ä»£ç  g_modbusMemory.registers.holding_registers[2] = (uint16_t)(g_systemStatus.uptime); // è¿è¡Œæ—¶é—´ } /** * @brief å¤„ç†Modbus RTUè¯·æ±‚ */ void ModbusServer_ProcessRTU(void) { static uint8_t rxBuffer[256]; static uint8_t txBuffer[256]; uint16_t rxLength, txLength; /* æ¥æ”¶æ•°æ® */ if (UART_ReceiveBuffer(&amp;huart1, rxBuffer, &amp;rxLength)) { /* è§£æModbusè¯·æ±‚ */ ModbusRequest_t request; if (Modbus_ParseRequest(rxBuffer, rxLength, &amp;request)) { /* å¤„ç†è¯·æ±‚ */ ModbusResponse_t response; Modbus_ProcessRequest(&amp;request, &amp;response); /* ç”Ÿæˆå“åº”å¸§ */ txLength = Modbus_GenerateResponse(&amp;response, txBuffer); /* å‘é€å“åº” */ UART_Transmit(&amp;huart1, txBuffer, txLength); } } } /** * @brief å¤„ç†Modbus TCPè¯·æ±‚ */ void ModbusServer_ProcessTCP(void) { /* TCPé€šä¿¡å¤„ç† (ç®€åŒ–å®ç°) */ uint8_t tcpBuffer[512]; uint16_t tcpLength; if (Ethernet_ReceiveData(tcpBuffer, &amp;tcpLength)) { /* è§£æMBAPå¤´éƒ¨å’ŒModbus PDU */ ModbusTCP_Request_t tcpRequest; if (ModbusTCP_ParseRequest(tcpBuffer, tcpLength, &amp;tcpRequest)) { /* å¤„ç†Modbusè¯·æ±‚ */ ModbusResponse_t response; Modbus_ProcessRequest(&amp;tcpRequest.modbus_request, &amp;response); /* ç”ŸæˆTCPå“åº” */ uint16_t responseLength; responseLength = ModbusTCP_GenerateResponse( &amp;tcpRequest, &amp;response, tcpBuffer); /* å‘é€TCPå“åº” */ Ethernet_TransmitData(tcpBuffer, responseLength); } } } /** * @brief å¤„ç†ModbusåŠŸèƒ½ç  */ void Modbus_ProcessRequest(ModbusRequest_t* request, ModbusResponse_t* response) { response-&gt;slave_address = request-&gt;slave_address; response-&gt;function_code = request-&gt;function_code; switch (request-&gt;function_code) { case MODBUS_FC_READ_HOLDING_REGISTERS: Modbus_ReadHoldingRegisters(request, response); break; case MODBUS_FC_READ_INPUT_REGISTERS: Modbus_ReadInputRegisters(request, response); break; case MODBUS_FC_WRITE_SINGLE_REGISTER: Modbus_WriteSingleRegister(request, response); break; case MODBUS_FC_WRITE_MULTIPLE_REGISTERS: Modbus_WriteMultipleRegisters(request, response); break; default: response-&gt;function_code |= 0x80; // å¼‚å¸¸å“åº” response-&gt;data[0] = MODBUS_EXCEPTION_ILLEGAL_FUNCTION; response-&gt;data_length = 1; break; } } ğŸ“Š æ•°æ®è®°å½•ä¸åˆ†æ æ•°æ®è®°å½•åŠŸèƒ½ /** * @file data_logger.c * @brief æ•°æ®è®°å½•æ¨¡å— */ #include &#34;data_logger.h&#34; #include &#34;flash.h&#34; #include &#34;rtc.h&#34; /* æ•°æ®è®°å½•ç»“æ„ */ typedef struct { uint32_t timestamp; float temperature; float pressure; float flow_rate; float vibration; uint16_t system_status; } DataRecord_t; /* å†å²æ•°æ®ç¼“å†²åŒº */ #define DATA_BUFFER_SIZE 1000 static DataRecord_t g_dataBuffer[DATA_BUFFER_SIZE]; static uint16_t g_dataBufferIndex = 0; static uint32_t g_totalRecords = 0; /** * @brief è®°å½•ä¼ æ„Ÿå™¨æ•°æ® */ void DataLogger_RecordData(SensorData_t* sensorData) { DataRecord_t* record = &amp;g_dataBuffer[g_dataBufferIndex]; /* å¡«å……æ•°æ®è®°å½• */ record-&gt;timestamp = RTC_GetTimestamp(); record-&gt;temperature = sensorData-&gt;temperature; record-&gt;pressure = sensorData-&gt;pressure; record-&gt;flow_rate = sensorData-&gt;flow_rate; record-&gt;vibration = sensorData-&gt;vibration; record-&gt;system_status = g_systemStatus.error_code; /* æ›´æ–°ç¼“å†²åŒºç´¢å¼• */ g_dataBufferIndex = (g_dataBufferIndex &#43; 1) % DATA_BUFFER_SIZE; g_totalRecords&#43;&#43;; /* æ£€æŸ¥æ˜¯å¦éœ€è¦ä¿å­˜åˆ°Flash */ if (g_dataBufferIndex % 100 == 0) { DataLogger_SaveToFlash(); } } /** * @brief æ•°æ®æ»¤æ³¢å¤„ç† */ void DataLogger_FilterSensorData(SensorData_t* sensorData) { static SensorData_t filterBuffer[5]; static uint8_t filterIndex = 0; /* æ›´æ–°æ»¤æ³¢ç¼“å†²åŒº */ filterBuffer[filterIndex] = *sensorData; filterIndex = (filterIndex &#43; 1) % 5; /* è®¡ç®—ç§»åŠ¨å¹³å‡å€¼ */ float tempSum = 0.0, pressureSum = 0.0; float flowSum = 0.0, vibrationSum = 0.0; for (int i = 0; i &lt; 5; i&#43;&#43;) { tempSum &#43;= filterBuffer[i].temperature; pressureSum &#43;= filterBuffer[i].pressure; flowSum &#43;= filterBuffer[i].flow_rate; vibrationSum &#43;= filterBuffer[i].vibration; } sensorData-&gt;temperature = tempSum / 5.0; sensorData-&gt;pressure = pressureSum / 5.0; sensorData-&gt;flow_rate = flowSum / 5.0; sensorData-&gt;vibration = vibrationSum / 5.0; } /** * @brief æ•°æ®æœ‰æ•ˆæ€§æ£€æŸ¥ */ bool DataLogger_ValidateSensorData(SensorData_t* sensorData) { bool isValid = true; /* æ¸©åº¦èŒƒå›´æ£€æŸ¥ */ if (sensorData-&gt;temperature &lt; -40.0 || sensorData-&gt;temperature &gt; 125.0) { sensorData-&gt;temperature = 25.0; // é»˜è®¤å€¼ isValid = false; } /* å‹åŠ›èŒƒå›´æ£€æŸ¥ */ if (sensorData-&gt;pressure &lt; 0.0 || sensorData-&gt;pressure &gt; 20.0) { sensorData-&gt;pressure = 0.0; isValid = false; } /* æµé‡èŒƒå›´æ£€æŸ¥ */ if (sensorData-&gt;flow_rate &lt; 0.0 || sensorData-&gt;flow_rate &gt; 1000.0) { sensorData-&gt;flow_rate = 0.0; isValid = false; } /* æŒ¯åŠ¨èŒƒå›´æ£€æŸ¥ */ if (sensorData-&gt;vibration &lt; 0.0 || sensorData-&gt;vibration &gt; 50.0) { sensorData-&gt;vibration = 0.0; isValid = false; } return isValid; } ğŸ”§ ç³»ç»Ÿæµ‹è¯•ä¸éªŒè¯ åŠŸèƒ½æµ‹è¯•æ¸…å• ç¡¬ä»¶æµ‹è¯•: âœ“ ç”µæºè¾“å…¥æµ‹è¯• (24V DC Â±10%) âœ“ å·¥ä½œæ¸©åº¦æµ‹è¯• (-20Â°C ~ &#43;70Â°C) âœ“ EMIæŠ—å¹²æ‰°æµ‹è¯• (IEC 61000-4-3) âœ“ é˜²æŠ¤ç­‰çº§æµ‹è¯• (IP65) âœ“ æŒ¯åŠ¨æµ‹è¯• (IEC 60068-2-6) è½¯ä»¶æµ‹è¯•: âœ“ ä¼ æ„Ÿå™¨ç²¾åº¦æµ‹è¯• (Â±0.1%) âœ“ Modbusé€šä¿¡æµ‹è¯• (RTU/TCP) âœ“ æ•°æ®è®°å½•æµ‹è¯• (1000æ¡/ç§’) âœ“ çœ‹é—¨ç‹—åŠŸèƒ½æµ‹è¯• âœ“ æ•…éšœæ¢å¤æµ‹è¯• æ€§èƒ½æŒ‡æ ‡: âœ“ å¯åŠ¨æ—¶é—´: &lt; 2ç§’ âœ“ æ•°æ®æ›´æ–°é¢‘ç‡: 10Hz âœ“ é€šä¿¡å“åº”æ—¶é—´: &lt; 100ms âœ“ å­˜å‚¨å®¹é‡: 10,000æ¡è®°å½• âœ“ åŠŸè€—: &lt; 5W ç°åœºæµ‹è¯•ç»“æœ æµ‹è¯•ç¯å¢ƒ: å·¥ä¸šæ³µç«™ç°åœº æµ‹è¯•æ—¶é—´: 72å°æ—¶è¿ç»­è¿è¡Œ ä¼ æ„Ÿå™¨æµ‹è¯•ç»“æœ: - æ¸©åº¦æµ‹é‡ç²¾åº¦: Â±0.05Â°C (PT100, 0-100Â°CèŒƒå›´) - å‹åŠ›æµ‹é‡ç²¾åº¦: Â±0.2%FS (4-20mA, 0-10Bar) - æµé‡æµ‹é‡ç²¾åº¦: Â±1.0% (è„‰å†²è¾“å‡º, 0-500L/min) - æŒ¯åŠ¨æµ‹é‡ç²¾åº¦: Â±5% (IEPE, 0-10g) é€šä¿¡æµ‹è¯•ç»“æœ: - Modbus RTU: 9600bps, 0é”™è¯¯ - Modbus TCP: 100Mbps, &lt;10mså»¶è¿Ÿ - æ•°æ®å®Œæ•´æ€§: 99.99% - è¿æ¥ç¨³å®šæ€§: 72å°æ—¶æ— æ–­çº¿ ç³»ç»Ÿç¨³å®šæ€§: - è¿ç»­è¿è¡Œæ—¶é—´: 72å°æ—¶ - å†…å­˜ä½¿ç”¨ç‡: 45% - CPUä½¿ç”¨ç‡: 30% - å­˜å‚¨ç©ºé—´ä½¿ç”¨: 23% ğŸ“ˆ é¡¹ç›®åº”ç”¨åœºæ™¯ å·¥ä¸šåº”ç”¨æ¡ˆä¾‹ æ³µç«™ç›‘æ§ç³»ç»Ÿ
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-11-12 12:00:00 +0800 CST'>2025-11-12</span>&nbsp;Â·&nbsp;<span>8 min</span>&nbsp;Â·&nbsp;<span>1603 words</span>&nbsp;Â·&nbsp;<span>dmk69</span></footer>
  <a class="entry-link" aria-label="post link to æ™ºèƒ½è®¾å¤‡æ§åˆ¶å•å…ƒ" href="http://localhost:1313/projects/embedded-control-unit/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">æ™ºèƒ½æ¤ç‰©ç›‘æ§ç³»ç»Ÿ
    </h2>
  </header>
  <div class="entry-content">
    <p>
ğŸŒ± é¡¹ç›®æ¦‚è¿° è¿™æ˜¯ä¸€ä¸ªåŸºäºArduinoçš„æ™ºèƒ½æ¤ç‰©ç›‘æ§ç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªåŠ¨ç›‘æµ‹æ¤ç‰©çš„ç”Ÿé•¿ç¯å¢ƒï¼Œå¹¶é€šè¿‡æ‰‹æœºAPPå®æ—¶æŸ¥çœ‹æ•°æ®ã€‚
ğŸ¯ é¡¹ç›®ç›®æ ‡ ç›‘æµ‹åœŸå£¤æ¹¿åº¦ã€æ¸©åº¦ã€å…‰ç…§å¼ºåº¦ è‡ªåŠ¨æµ‡æ°´åŠŸèƒ½ æ•°æ®è®°å½•å’Œåˆ†æ æ‰‹æœºè¿œç¨‹æ§åˆ¶ ğŸ”§ æ‰€éœ€ææ–™ ç¡¬ä»¶ç»„ä»¶ Arduino Uno R3 Ã— 1 ESP8266 WiFiæ¨¡å— Ã— 1 åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ Ã— 1 DHT22æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ Ã— 1 å…‰æ•ç”µé˜» Ã— 1 æ°´æ³µ Ã— 1 ç»§ç”µå™¨æ¨¡å— Ã— 1 OLEDæ˜¾ç¤ºå± Ã— 1 é¢åŒ…æ¿å’Œè·³çº¿è‹¥å¹² æˆæœ¬é¢„ç®— ç»„ä»¶ ä»·æ ¼ æ•°é‡ å°è®¡ Arduino Uno ï¿¥45 1 ï¿¥45 ESP8266 ï¿¥20 1 ï¿¥20 ä¼ æ„Ÿå™¨å¥—è£… ï¿¥35 1å¥— ï¿¥35 æ°´æ³µ&#43;ç»§ç”µå™¨ ï¿¥25 1å¥— ï¿¥25 OLEDæ˜¾ç¤ºå± ï¿¥18 1 ï¿¥18 æ€»è®¡ ï¿¥143 ğŸ”Œ ç¡¬ä»¶è¿æ¥ ä¼ æ„Ÿå™¨è¿æ¥ // å¼•è„šå®šä¹‰ #define SOIL_MOISTURE_PIN A0 // åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ #define DHT_PIN 2 // æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ #define LIGHT_SENSOR_PIN A1 // å…‰æ•ç”µé˜» #define PUMP_PIN 3 // æ°´æ³µæ§åˆ¶ #define OLED_SDA_PIN A4 // OLED SDA #define OLED_SCL_PIN A5 // OLED SCL è¿æ¥å›¾ Arduino Uno: A0 â”€â”€ åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ A1 â”€â”€ å…‰æ•ç”µé˜» &#43; 10kÎ©ç”µé˜» A4 â”€â”€ OLED SDA A5 â”€â”€ OLED SCL D2 â”€â”€ DHT22 æ•°æ®çº¿ D3 â”€â”€ ç»§ç”µå™¨æ§åˆ¶ç«¯ 5V â”€â”€ ä¼ æ„Ÿå™¨ç”µæº GND â”€â”€ å…¬å…±åœ° ğŸ’» è½¯ä»¶ä»£ç  ä¸»ç¨‹åº #include &lt;DHT.h&gt; #include &lt;Adafruit_GFX.h&gt; #include &lt;Adafruit_SSD1306.h&gt; #include &lt;SoftwareSerial.h&gt; #include &lt;ArduinoJson.h&gt; // ä¼ æ„Ÿå™¨åˆå§‹åŒ– DHT dht(DHT_PIN, DHT22); Adafruit_SSD1306 display(128, 64, &amp;Wire, -1); SoftwareSerial esp(10, 11); // RX, TX // å…¨å±€å˜é‡ float temperature, humidity; int soilMoisture, lightLevel; bool pumpStatus = false; unsigned long lastCheckTime = 0; const unsigned long CHECK_INTERVAL = 30000; // 30ç§’æ£€æŸ¥ä¸€æ¬¡ void setup() { Serial.begin(9600); esp.begin(9600); dht.begin(); // OLEDåˆå§‹åŒ– if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) { Serial.println(F(&#34;SSD1306 allocation failed&#34;)); } pinMode(PUMP_PIN, OUTPUT); pinMode(SOIL_MOISTURE_PIN, INPUT); pinMode(LIGHT_SENSOR_PIN, INPUT); digitalWrite(PUMP_PIN, LOW); // æ˜¾ç¤ºå¯åŠ¨ç”»é¢ displayBootScreen(); } void loop() { // å®šæ—¶æ£€æŸ¥ä¼ æ„Ÿå™¨æ•°æ® if (millis() - lastCheckTime &gt; CHECK_INTERVAL) { readSensors(); updateDisplay(); checkAutoWater(); sendDataToServer(); lastCheckTime = millis(); } // æ£€æŸ¥æ‰‹æœºAPPæŒ‡ä»¤ checkMobileCommand(); delay(1000); } void readSensors() { // è¯»å–æ¸©æ¹¿åº¦ temperature = dht.readTemperature(); humidity = dht.readHumidity(); // è¯»å–åœŸå£¤æ¹¿åº¦ (0-1023, æ•°å€¼è¶Šå°è¶Šæ¹¿æ¶¦) soilMoisture = analogRead(SOIL_MOISTURE_PIN); // è¯»å–å…‰ç…§å¼ºåº¦ lightLevel = analogRead(LIGHT_SENSOR_PIN); Serial.print(&#34;æ¸©åº¦: &#34;); Serial.print(temperature); Serial.print(&#34;Â°C, æ¹¿åº¦: &#34;); Serial.print(humidity); Serial.print(&#34;%, åœŸå£¤æ¹¿åº¦: &#34;); Serial.print(soilMoisture); Serial.print(&#34;, å…‰ç…§: &#34;); Serial.println(lightLevel); } void updateDisplay() { display.clearDisplay(); display.setTextSize(1); display.setTextColor(SSD1306_WHITE); display.setCursor(0, 0); display.print(&#34;æ™ºèƒ½æ¤ç‰©ç›‘æ§&#34;); display.setCursor(0, 16); display.printf(&#34;æ¸©åº¦:%.1fÂ°C æ¹¿åº¦:%.0f%%&#34;, temperature, humidity); display.setCursor(0, 32); display.printf(&#34;åœŸå£¤:%d å…‰ç…§:%d&#34;, 1024-soilMoisture, lightLevel); display.setCursor(0, 48); display.print(&#34;æ°´æ³µ:&#34;); display.print(pumpStatus ? &#34;å¼€å¯&#34; : &#34;å…³é—­&#34;); display.display(); } void checkAutoWater() { // åœŸå£¤æ¹¿åº¦é˜ˆå€¼ (å¯æ ¹æ®æ¤ç‰©ç±»å‹è°ƒæ•´) int moistureThreshold = 700; if (soilMoisture &gt; moistureThreshold &amp;&amp; !pumpStatus) { startPump(); } else if (soilMoisture &lt; moistureThreshold - 100 &amp;&amp; pumpStatus) { stopPump(); } } void startPump() { digitalWrite(PUMP_PIN, HIGH); pumpStatus = true; Serial.println(&#34;å¯åŠ¨æ°´æ³µæµ‡æ°´&#34;); } void stopPump() { digitalWrite(PUMP_PIN, LOW); pumpStatus = false; Serial.println(&#34;åœæ­¢æ°´æ³µ&#34;); } void sendDataToServer() { DynamicJsonDocument doc(1024); doc[&#34;temperature&#34;] = temperature; doc[&#34;humidity&#34;] = humidity; doc[&#34;soilMoisture&#34;] = 1024 - soilMoisture; // è½¬æ¢ä¸ºæ¹¿åº¦ç™¾åˆ†æ¯” doc[&#34;lightLevel&#34;] = lightLevel; doc[&#34;pumpStatus&#34;] = pumpStatus; doc[&#34;timestamp&#34;] = millis(); serializeJson(doc, esp); esp.println(); } void checkMobileCommand() { if (esp.available()) { String command = esp.readStringUntil(&#39;\n&#39;); command.trim(); if (command == &#34;PUMP_ON&#34;) { startPump(); } else if (command == &#34;PUMP_OFF&#34;) { stopPump(); } else if (command == &#34;GET_DATA&#34;) { sendDataToServer(); } } } void displayBootScreen() { display.clearDisplay(); display.setTextSize(2); display.setTextColor(SSD1306_WHITE); display.setCursor(20, 20); display.print(&#34;æ¤ç‰©å«å£«&#34;); display.setTextSize(1); display.setCursor(30, 50); display.print(&#34;System Starting...&#34;); display.display(); delay(2000); } ğŸ“± æ‰‹æœºAPPç•Œé¢ Blynké…ç½® ä½¿ç”¨Blynkå¹³å°å¿«é€Ÿåˆ›å»ºæ‰‹æœºæ§åˆ¶ç•Œé¢ï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-11-05 15:30:00 +0800 CST'>2025-11-05</span>&nbsp;Â·&nbsp;<span>3 min</span>&nbsp;Â·&nbsp;<span>562 words</span>&nbsp;Â·&nbsp;<span>dmk69</span></footer>
  <a class="entry-link" aria-label="post link to æ™ºèƒ½æ¤ç‰©ç›‘æ§ç³»ç»Ÿ" href="http://localhost:1313/projects/smart-plant-monitor/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">åˆ›å®¢æ•™è‚²åšå®¢</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
